---
title: "MCIS with growing graphs: results from a single run"
geometry: margin=2cm
output:
  pdf_document: default
---

```{r include=FALSE}
counts <- read.csv("results/counts.csv")
densities <- read.csv("results/densities.csv")
summary <- read.csv("results/summary.csv")

x <- function(N) {
    a <- 4/log(2)
    b <- -2/log(2)
    c <- 1/2 * a * (1-log(a))
    round(a * log(N) + b * log(log(N)) + c)
}
summary$x <- x(summary$n)

summary <- summary[, c("n", "k", "x", "count")]
```

This hastily-written note gives some results from an MCIS experiment with a sample size of one.  
It is an initial attempt to answer some questions posed by Donald Knuth and related to the
paper ``Isomorphisms Between Random Graphs'' by Persi Diaconis and Sourav Chatterjee.

We start with graphs $G_1$ and $H_1$, each with a single vertex.  Graphs $G_n$ and $H_n$
each have $n$ vertices; they are generated by adding a single vertex to each of $G_{n-1}$
and $H_{n-1}$, then adding each possible edge incident to the new vertex with probability $1/2$.

For this experiment, we show results up to $n=30$.  (A single run with $n$ in the high thirties
is likely to take around a day.)

Table 1 shows, for each $n$: the order $k$ of a MCIS of $G_n$ and $H_n$, the value $x$
given by the formula of Diaconis and Chatterjee, and the number of MCISs of $G_n$ and $H_n$.

```{r echo=FALSE, fig.height=7}
knitr::kable(summary, caption="For each graph order (n): the number of vertices in an MCIS (k), predicted number of vertices (x), and number of MCISs (count)")
```
\newpage

Is it the case that some vertices appear in many MCISs, while others appear in no MCISs at all?
The following figure has a subfigure for each $n$, and shows the number of MCISs in which each vertex
of graph $G$ appears.  It seems that the vertices are all involved in similar numbers of MCISs.

```{r echo=FALSE, fig.height=7.5}
ggplot2::ggplot(counts[counts$v != -1 & counts$graph=="G", ], ggplot2::aes(v, count)) +
  ggplot2::geom_col() +
  ggplot2::facet_wrap(ggplot2::vars(n)) +
  ggplot2::theme_bw() +
  ggplot2::xlab("Vertex (v) of graph G") +
  ggplot2::ylab("Number of MCISs in which v is present") +
  ggplot2::labs(title = "How many MCISs does each vertex appear in?",
                subtitle = "Subfigure n is for input graphs of order n")
```

\newpage

Do the MCISs tend to be unusually sparse or dense?  The following set of histograms (one for each $n$)
show the distribution of densities of MCISs.  I also tried plotting histograms (not shown here) where
randomly-chosen subgraphs were used in place of MCISs; these looked very similar to the ones shown in the
figure, suggesting that MCISs perhaps don't have particularly unusual densities.

```{r echo=FALSE, fig.height=7.5}
ggplot2::ggplot(densities[densities$real=="real" & densities$n >= 10, ], ggplot2::aes(x=density)) +
  ggplot2::geom_histogram(binwidth=.01) +
  ggplot2::facet_wrap(ggplot2::vars(n)) +
  ggplot2::theme_bw() +
  ggplot2::labs(title = "How dense are MCISs?",
                subtitle = "Subfigure n is for input graphs of order n")
```

```{r echo=FALSE, fig.height=10}
ggplot2::ggplot(densities[densities$n >= 10, ], ggplot2::aes(x=density)) +
  ggplot2::geom_histogram(binwidth=.01) +
  ggplot2::facet_grid(ggplot2::vars(n), ggplot2::vars(real)) +
  ggplot2::theme_bw()
```
